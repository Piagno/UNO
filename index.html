<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>UNO by piagno</title>
        <link rel="stylesheet" href="style.css" />
        <script src="game.js"></script>
        <script>
            window.onload = (r)=>{
                let uno = document.getElementById('uno')
                function displayCard(card){
                    let deck = document.getElementById('deck')
                    deck.innerText = 'Card: '+card.color+' '
                    if(card.number === undefined){
                        deck.innerText += ' '+card.action
                    }else{
                        deck.innerText += ' '+card.number
                    }
                }
                function displayDeck(player,deck,chosenCard){
                    let place = document.getElementById('currentPlayer')
                    place.innerHTML = ''
                    deck.forEach((card)=>{
                        let cardEl = document.createElement('div')
                        cardEl.innerHTML = 'Card: '+card.color+' '
                        if(card.number === undefined){
                            cardEl.innerHTML += card.action
                        }else{
                            cardEl.innerHTML += card.number
                        }
                        cardEl.onclick = ()=>{
                            place.innerHTML = ''
                            chosenCard(card)
                        }
                        place.appendChild(cardEl)
                    })
                }
                function displayNext(player){
                    let ready = document.getElementById('ready')
                    ready.innerHTML = ''
                    let playerNameEL = document.createElement('div')
                    playerNameEL.innerText = 'Next Player: '+player
                    ready.appendChild(playerNameEL)
                    let playerReadyEL = document.createElement('button')
                    playerReadyEL.type = 'button'
                    playerReadyEL.innerText = 'Click here, when you are ready!'
                    playerReadyEL.onclick = function(){
                        ready.innerHTML = ''
                        game.playerReady(player)
                    }
                    ready.appendChild(playerReadyEL)
                }
                game = new UNO(7)
                let piagno = game.newPlayer('Piagno')
                let marco = game.newPlayer('Marco')
                let erik = game.newPlayer('Erik')
                let anna = game.newPlayer('Anna')
                game.giveCards()
                game.onPlayerFinished = (nextPlayer)=>{
                    displayNext(nextPlayer)
                }
                game.onPlayerNext = (player,chosenCard)=>{
                    displayDeck(player,player.deck,chosenCard)
                }
                game.displayCard = (card)=>{
                    displayCard(card)
                }
                game.start((card)=>{
                    displayCard(card)
                })
            }
        </script>
    </head>
    <body>
        <div id="uno">
            <div id="currentPlayer"></div>
            <div id="ready"></div>
            <div id="deck"></div>
        </div>
        <div id="logger"></div>
    </body>
</html>